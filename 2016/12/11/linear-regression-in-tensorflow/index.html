<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Linear Regression In TensorFlow &middot; My Learning Curve</title>
    <meta name="generator" content="Hugo 0.16-DEV" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Parvez Rafi">
    
      <meta name="description" content="">
    
    
    <link rel="canonical" href="https://rafiparvez.github.io/2016/12/11/linear-regression-in-tensorflow"/>
    <link rel="icon" href="https://rafiparvez.github.io/favicon.ico">
    <link rel="apple-touch-icon" href="https://rafiparvez.github.io/apple-touch-icon.png"/>
    <link rel="stylesheet" href="https://rafiparvez.github.io/css/style.css">
    <link rel="stylesheet" href="https://rafiparvez.github.io/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://rafiparvez.github.io/css/monokai.css">
    <link rel="stylesheet" href="https://rafiparvez.github.io/fancybox/jquery.fancybox.css">
    
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta property="og:title" content="Linear Regression In TensorFlow" />
<meta property="og:description" content="This article explains how to implement linear regression in using Tensorflow. TensorFlow is an open-source library released by Google Brain Team in 2015 for numerical computations using dataflow graphs. Before we dive into implementing Linear Regression algorithm using Tensorflow, let me give you a brief primer on linear regression. Linear Regression Regression problem in machine learning means predicting continuous valued outputs. When regression problem arises in situations, when there exists a nearly linear relation between input and output variables, we classify such problems under linear regression." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rafiparvez.github.io/2016/12/11/linear-regression-in-tensorflow" />


<meta property="og:updated_time" content="2016-12-11T22:50:08&#43;02:00"/>










    
    
<meta itemprop="name" content="Linear Regression In TensorFlow">
<meta itemprop="description" content="This article explains how to implement linear regression in using Tensorflow. TensorFlow is an open-source library released by Google Brain Team in 2015 for numerical computations using dataflow graphs. Before we dive into implementing Linear Regression algorithm using Tensorflow, let me give you a brief primer on linear regression. Linear Regression Regression problem in machine learning means predicting continuous valued outputs. When regression problem arises in situations, when there exists a nearly linear relation between input and output variables, we classify such problems under linear regression.">


<meta itemprop="dateModified" content="2016-12-11T22:50:08&#43;02:00" />
<meta itemprop="wordCount" content="821">



<meta itemprop="keywords" content="machine-learning,tensorflow," />

    

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:title" content="Linear Regression In TensorFlow"/>
<meta name="twitter:description" content="This article explains how to implement linear regression in using Tensorflow. TensorFlow is an open-source library released by Google Brain Team in 2015 for numerical computations using dataflow graphs. Before we dive into implementing Linear Regression algorithm using Tensorflow, let me give you a brief primer on linear regression. Linear Regression Regression problem in machine learning means predicting continuous valued outputs. When regression problem arises in situations, when there exists a nearly linear relation between input and output variables, we classify such problems under linear regression."/>
<meta name="twitter:site" content="@parvez_rafi"/>


    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
<div class="container">


<div id="container">
	<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="https://rafiparvez.github.io/" id="logo">
          
          <i class="logo" style="background-image: url('https://rafiparvez.github.io/css/images/logo.png')"></i>
          
          <span class="site-title">My Learning Curve</span>
      </a>
      <nav id="main-nav">
          
          
          <a class="main-nav-link" href="https://rafiparvez.github.io/">Blog</a>
          
          
          
          
          
          

          

          
          
          
          
          <a class="main-nav-link" href="https://rafiparvez.github.io/project/">Project</a>
          
          
          
          <a class="main-nav-link" href="https://rafiparvez.github.io/AboutMe">About</a>
          
          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://rafiparvez.github.io/css/images/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>

    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          
          
          <td><a class="main-nav-link" href="https://rafiparvez.github.io/">Blog</a></td>
          
          
          
          
          
          

          

          
          
          
          
          <td><a class="main-nav-link" href="https://rafiparvez.github.io/project/">Project</a></td>
          
          
          
          <td><a class="main-nav-link" href="https://rafiparvez.github.io/AboutMe">About</a></td>
          
          

      </tr>
      </tbody>
    </table>
  </div>
</header>

   	
   	<div class="outer">
   		
	    <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="https://rafiparvez.github.io/css/images/avatar.png">
      <h2 id="name">Parvez Rafi</h2>
      <h3 id="title">Blogger - Programmer - Artist</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Texas, USA</span>
      
          <a id="follow" href="https://github.com/rafiparvez">
              Follow
          </a>
      
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        1
        <span>Posts</span>
      </div>
      <div class="article-info-block">
        4
        <span>Projects</span>
      </div>
      
    </div>
    <div class="profile-block social-links">
      <table>
        <tr>
          
<td><a href="//github.com/rafiparvez" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>





































<td><a href="//linkedin.com/in/rafiparvez" target="_blank" title="LinkedIn"><i class="fa fa-linkedin"></i></a></td>













<td><a href="//facebook.com/parvez.rafi.12" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>



<td><a href="//twitter.com/parvez_rafi" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>
</aside>

	    

	    
<section id="main">

    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">
        <div class="article-inner">
            
                <img src="https://rafiparvez.github.io/banners/tf.jpg" class="article-banner">
            

            <header class="article-header">
    <a href="https://rafiparvez.github.io/2016/12/11/linear-regression-in-tensorflow">
    <h1 class="article-title" itemprop="name">
        Linear Regression In TensorFlow
    </h1>
    </a>
    <div class="article-meta">
        
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2016-12-11 22:50:08 &#43;0200 &#43;0200" itemprop="datePublished">11/12/2016</time>
            &middot;
            821
            words

        </div>
        

        
            
            
            <div class="article-category">
                <i class="fa fa-folder"></i>
                
                
                <a class="article-category-link" href="categories/machine-learning">machine learning</a>
                
                
            </div>
            
        

        
            
            
            <div class="article-category">
                <i class="fa fa-tags"></i>
                
                
                <a class="article-category-link" href="tags/tensorflow">Tensorflow</a>
                
                
            </div>
            
        
    </div>
</header>

            <div class="article-entry" itemprop="articleBody">
                

<p>This article explains how to implement linear regression in using Tensorflow.</p>

<p>TensorFlow is an open-source library released by Google Brain Team in 2015 for numerical computations using dataflow graphs. Before we dive into implementing Linear Regression algorithm using Tensorflow, let me give you a brief primer on <em>linear regression</em>.</p>

<h4 id="linear-regression:151d92fb75a508007a285feb55442c14">Linear Regression</h4>

<p>Regression problem in machine learning means predicting <em>continuous valued outputs</em>. When regression problem arises in situations, when there exists a nearly linear relation between input and output variables, we classify such problems under <em>linear regression</em>. For example, let us assume that we were given a probelm to predict the amount of money a person spends in a year. Although, a person&rsquo;s spending may depend on many other factors, but to simplify the problem, let&rsquo;s us focus on the relation between people&rsquo;s expenditures and their incomes. Generally, the relation between people&rsquo;s expenditures and incomes may not be perfectly linear, but when we plot this relation for different people, as depicted by the scatter plot below, there may exist a nearly linear relation between these two quantities.</p>

<p><img src="/linear_reg/Spend-vs-income.png" title="Expenditure V/S Income"></p>

<p>The solution to linear regression problem now boils down to finding a linear model which best estimates the behavior of the relation between input(income) and output(expenditure) variables. This best fit continuos linear model then helps us predict an estimate for the expenditure corresponding to any income value. The following graph depicts what we mean by best fit linear model.</p>

<p><img src="/linear_reg/Best-Fit.png" title="Best-Fit Linear Model"></p>

<p>Mathematically, a linear model can be represented by.<br />
$y = ax+b$<br />
where,<br />
$y$ = independent variable (income in our example)<br />
$x$ = dependent variable (expenditure in our example)<br />
$a$ = slope or gradient<br />
$b$ = intercept</p>

<p>In order to find best fit, we try minimize the residual variation between out model(hypothesis) and actual output values.</p>

<p>Best fit :   $min \sum\limits_{i}(y_i - \hat{y_i})^2$<br />
where $y_i$ = actual output value for $i^{th}$ obervation<br />
and $\hat{y_i}$ = predicted output value for $i^{th}$ obervation</p>

<p>In the example presented above, output depended upon single input variable. Such problems are called <em>univariate linear regression</em>  problems. Practically, the amount a person spends may depend on many other factors or input variables. These problems are then classified as <em>multiivariate linear regression</em> problems. In such cases, the input is represented by a vector (a list of input variables). To simplify things, we will limit out implementation to univariate linear regression.</p>

<h4 id="implementing-linear-regression-using-tensorflow:151d92fb75a508007a285feb55442c14">Implementing Linear Regression Using TensorFlow</h4>

<p>First we import necessary libraries.</p>

<pre><code>import numpy as np
import tensorflow as tf
import matplotlib.patches as mpatches
import matplotlib.pyplot as mplt
</code></pre>

<p>Next we generate x and y data (actual or training data) that will be used as input to train our linear model.</p>

<pre><code>x_data= np.arange(0, 100, 1)
y_data = 0.5*x_data + 1

#Adding some Gaussian noise to y_data
y_data = np.vectorize(lambda y : y + np.random.normal(loc=5.0,scale=5.0))(y_data)
mplt.plot(x_data, y_data, 'bo')
mplt.ylabel('Expenditure ( x 100)')
mplt.xlabel('Income ( x 1,000)')
mplt.show()
</code></pre>

<p>The training data generated above appears as follows.<br />
<img src="/linear_reg/Spend-vs-income.png" title="Expenditure V/S Income"></p>

<p>Now we initialize variables a and b in tensorflow. We can give any random initial values to values to $a$ and $b$. The gradient descent optmizer that we implement below, will ultimately optimize these values that represents best linear fit in $y = ax+b$</p>

<pre><code>a=tf.Variable(1.0)
b=tf.Variable(0.0)
</code></pre>

<p>Then we define a linear function.</p>

<pre><code>y=a*x_data + b
</code></pre>

<p>As discussed above, in linear regression we try to minimize residual error between hypothesis and actual y data. For which we find a residual error value.
reduce_mean() function calculates mean of a mathematical function.</p>

<pre><code>residual=tf.reduce_mean(tf.square(y - y_data))
</code></pre>

<p>Now we define the optimizer method. Here we use simple gradient descent of 0.0001 and then we try to minimize the residual error. In tensorflow every operation is executed in a session. So we create session using Session() method. All variables to be used in operations must be initialized first.</p>

<pre><code>optimizer = tf.train.GradientDescentOptimizer(0.0001)
train = optimizer.minimize(residual)

init=tf.initialize_all_variables()
sess = tf.Session()
sess.run(init)

train_data =[]
for step in range(1000):
    evals = sess.run([train,a,b])[1:]
    if step%50 ==0:
        print(step, evals)
        train_data.append(evals)
</code></pre>

<p>In the output below, we can see how values of a,b converge to their optimized values that will give us best fit model.</p>

<p>0 [0.73032355, -0.0037603895]<br />
50 [0.58921194, 0.0093623158]<br />
100 [0.58898264, 0.024570402]<br />
150 [0.58875394, 0.039739955]<br />
200 [0.58852577, 0.054871064]<br />
250 [0.58829826, 0.069963828]<br />
300 [0.58807129, 0.085018359]<br />
350 [0.58784491, 0.10003471]<br />
400 [0.58761907, 0.11501303]<br />
450 [0.58739382, 0.12995344]<br />
500 [0.58716917, 0.1448559]<br />
550 [0.58694506, 0.15972069]<br />
600 [0.58672148, 0.17454772]<br />
650 [0.5864985, 0.18933743]<br />
700 [0.58627611, 0.20408921]<br />
750 [0.58605427, 0.21880373]<br />
800 [0.58583295, 0.233481]<br />
850 [0.58561224, 0.24812102]<br />
900 [0.58539212, 0.26272413]<br />
950 [0.58517247, 0.27729002]</p>

<p>Let us plot these values to understand the above convergence better.</p>

<pre><code>converter = mplt.colors
cr, cg, cb = (1.0,1.0,0.0)
for f in train_data:
    print(cr, cg, cb)
    cb+=1.0/ len(train_data)
    cg-=1.0/len(train_data)
    if cb&gt;1.0: cb=1.0
    if cg&lt;0.0: cg=0.0
    [a,b] = f
    f_y = np.vectorize(lambda x: a*x +b)(x_data)
    line = mplt.plot(x_data, f_y)
    mplt.setp(line, color=(cr,cg,cb))

mplt.plot(x_data, y_data, 'bo')

blue_line = mpatches.Patch(color='blue', label='Data Points')
pink_line = mpatches.Patch(color='magenta', label='Best Fit Linear Model')
yellow_line = mpatches.Patch(color='yellow', label='Possible Linear Models')

mplt.legend(handles=[blue_line, yellow_line, pink_line])
mplt.ylabel('Expenditure ( x 100)')
mplt.xlabel('Income ( x 1,000)')

mplt.show()
</code></pre>

<p>The pink line below represents the best fit linear model.</p>

<p><img src="/linear_reg/Best-Fit.png" title="Best-Fit Linear Model"></p>

            </div>
            <footer class="article-footer">
    
    <a data-url="https://rafiparvez.github.io/2016/12/11/linear-regression-in-tensorflow" data-id="151d92fb75a508007a285feb55442c14" class="article-share-link">
        <i class="fa fa-share"></i>
        Share
    </a>
    

    <script>
    (function ($) {
        
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
    </script>
    
</footer>

        </div>

        



    </article>

    
</section>


	    
	    <aside id="sidebar">
    
<div class="widget-wrap">
    <h3 class="widget-title">
        Recent Posts
    </h3>
    <div class="widget">
        <ul id="recent-post">
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://rafiparvez.github.io/2016/12/11/linear-regression-in-tensorflow" class="thumbnail">
                    
                        <span style="background-image:url(https://rafiparvez.github.io/banners/tf.jpg)" alt="Linear Regression In TensorFlow" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    
                    <p class="item-category">
                        
                        <a class="article-category-link" href="https://rafiparvez.github.io/categories/machine-learning">
                        machine learning
                        </a>
                    </p>
                    
                    
                    <p class="item-title"><a href="https://rafiparvez.github.io/2016/12/11/linear-regression-in-tensorflow" class="title">Linear Regression In TensorFlow</a></p>
                    <p class="item-date">
                        <time datetime="2016-12-11 22:50:08 &#43;0200 &#43;0200" itemprop="datePublished">11/12/2016</time>
                    </p>
                </div>
            </li>
            
        </ul>
    </div>
</div>


    


<div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://rafiparvez.github.io/categories/machine-learning">
                    machine-learning
                </a>
                <span class="category-list-count">1</span>
            </li>
            
        </ul>
    </div>
</div>




    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tags
    </h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://rafiparvez.github.io/tags/tensorflow">
                    tensorflow
                </a>
                <span class="category-list-count">1</span>
            </li>
            
        </ul>
    </div>
</div>




    


    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

	    
	</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017
      Parvez Rafi
    </div>
  </div>
</footer>


<script src="https://rafiparvez.github.io/fancybox/jquery.fancybox.pack.js"></script>
<script src="https://rafiparvez.github.io/js/script.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<!-- MathJax -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



</body>
</html>
